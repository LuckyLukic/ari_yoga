// prisma/schema.prisma

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Video {
  id          String   @id @default(cuid())
  slug        String   @unique
  title       String
  description String?
  durationMin Int?
  level       String   // Base | Intermedio | Avanzato
  premium     Boolean  @default(false)
  posterUrl   String?
  srcUrl      String?

  playlistItems PlaylistItem[]

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Playlist {
  id          String         @id @default(cuid())
  slug        String         @unique
  title       String
  description String?
  items       PlaylistItem[]

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model PlaylistItem {
  id         String   @id @default(cuid())
  playlistId String
  videoId    String
  position   Int

  playlist   Playlist @relation(fields: [playlistId], references: [id], onDelete: Cascade)
  video      Video    @relation(fields: [videoId], references: [id], onDelete: Cascade)

  @@unique([playlistId, videoId])
  @@index([playlistId, position])
}
